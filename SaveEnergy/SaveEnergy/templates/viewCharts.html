<div id="{{userNumber}}ColorDiv" class=""></div>
<script>
	if("{{userNumber}}" == "one"){
	    window["{{userNumber}}"] = "1";
	    $('#'+'{{userNumber}}'+"ColorDiv").removeClass();
	    $('#'+'{{userNumber}}'+"ColorDiv").addClass('glowing-box-1');
	}
	else{
	    if("{{userNumber}}" == "two") {
	        window["{{userNumber}}"] ="2";
	        $('#'+'{{userNumber}}'+"ColorDiv").removeClass();
	    	$('#'+'{{userNumber}}'+"ColorDiv").addClass('glowing-box-2');
	    }
	    else{
	        if("{{userNumber}}" == "three") {
	            window["{{userNumber}}"] ="3";
	            $('#'+'{{userNumber}}'+"ColorDiv").removeClass();
	    		$('#'+'{{userNumber}}'+"ColorDiv").addClass('glowing-box-3');
	        }
	        else{
	            window["{{userNumber}}"] ="4";
	            $('#'+'{{userNumber}}'+"ColorDiv").removeClass();
	    		$('#'+'{{userNumber}}'+"ColorDiv").addClass('glowing-box-4');
	        }
	    }
	}


	//logout listener ------------------------------------------------
	window['{{userID}}logOutViewCharts'] = function(data){
		// alert(userArray);
		// alert(sessionStorage.noOfUsers);
		sessionStorage.noOfUsers = parseInt(sessionStorage.noOfUsers) - 1;
		userArray[parseInt(window["{{userNumber}}"])-1] = false;
		if(window["{{userNumber}}"] == '1'){
	        window.clearTimeout(timeoutId1);
	    }
	    else{
	        if(window["{{userNumber}}"] == '2'){
	            window.clearTimeout(timeoutId2);
	        }else{
	            if(window["{{userNumber}}"] == '3'){
	                window.clearTimeout(timeoutId3);
	            }
	            else{
	                window.clearTimeout(timeoutId4);
	            }
	        }
	    }
		window["{{userNumber}}Privacy"] = 'low';
		$.ajax({
            url: "/logout/",
            type: "POST",
            data: {
            	'csrfmiddlewaretoken':"{{csrf_token}}",
            	'userID':"{{userID}}"
           	},
            success: function(data){
            	$('#'+"{{userNumber}}").empty();
            	$('#'+"{{userNumber}}").hide(1000);
            	if(sessionStorage.noOfUsers == 0) {
                    $('#welcomePage').show(1000);
                }
                else{
                    if(sessionStorage.noOfUsers == 1){
                		for(var i=0 ; i<userArray.length ; i++){
                			if(userArray[i] == true){
                				$('#'+getUserNumber(userNumberArray[i]+'')).removeClass()
                				$('#'+getUserNumber(userNumberArray[i]+'')).addClass("one_one" , 1500);
								if($('#'+getUserNumber(userNumberArray[i]+'')).find($("div.devicesContainer")).length > 0){
                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.level2').addClass('level');
                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.level2').removeClass('level2');
                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.money2').addClass('money');
                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.money2').removeClass('money2');
                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.badges2').addClass('badges');
                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.badges2').removeClass('badges2');
                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.pieCanvas2').addClass('pieCanvas');
                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.pieCanvas2').removeClass('pieCanvas2');
                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.NoBadgesTitle2').addClass('NoBadgesTitle');
                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.NoBadgesTitle2').removeClass('NoBadgesTitle2');
                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.badgesTitle').show();
								}
								else{
									if($('#'+getUserNumber(userNumberArray[i]+'')).find($("div.chartContainer")).length > 0){
                    					$('#'+getUserNumber(userNumberArray[i]+'')).find('.ViewChartsPieCanvas2').addClass('ViewChartsPieCanvas');
                    					$('#'+getUserNumber(userNumberArray[i]+'')).find('.ViewChartsPieCanvas2').removeClass('ViewChartsPieCanvas2');
                    					$('#'+getUserNumber(userNumberArray[i]+'')).find('.ViewChartsBarCanvas2').addClass('ViewChartsBarCanvas');
                    					$('#'+getUserNumber(userNumberArray[i]+'')).find('.ViewChartsBarCanvas2').removeClass('ViewChartsBarCanvas2');
									}
									else{
										if($('#'+getUserNumber(userNumberArray[i]+'')).find($("div.preChartContainer")).length > 0){
                        					$('#'+getUserNumber(userNumberArray[i]+'')).find('.preChartContainer2').addClass('preChartContainer');
                        					$('#'+getUserNumber(userNumberArray[i]+'')).find('.preChartContainer2').removeClass('preChartContainer2');
										}
									}
								}
								break;
                			}
                		}
                    }
                    else{
                        if(sessionStorage.noOfUsers == 2){
                        	j=0;
                        	for(var i=0 ; i<userArray.length ; i++){
                    			if(userArray[i] == true){
                    				if($('#'+getUserNumber(userNumberArray[i]+'')).find($("div.devicesContainer")).length > 0){
					            		if(sessionStorage.noOfUsers != 1){
		                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.level3').addClass('level'+sessionStorage.noOfUsers);
		                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.level3').removeClass('level3');
		                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.money3').addClass('money'+sessionStorage.noOfUsers);
		                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.money3').removeClass('money3');
		                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.badges3').addClass('badges'+sessionStorage.noOfUsers);
		                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.badges3').removeClass('badges3');
		                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.pieCanvas3').addClass('pieCanvas'+sessionStorage.noOfUsers);
		                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.pieCanvas3').removeClass('pieCanvas3');
		                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.NoBadgesTitle3').addClass('NoBadgesTitle'+sessionStorage.noOfUsers);
		                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.NoBadgesTitle3').removeClass('NoBadgesTitle3');
		                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.badgesTitle').hide();
		                				}
									}
									else{
										if($('#'+getUserNumber(userNumberArray[i]+'')).find($("div.chartContainer")).length > 0){
											if(sessionStorage.noOfUsers != 1){
		                    					$('#'+getUserNumber(userNumberArray[i]+'')).find('.ViewChartsPieCanvas3').addClass('ViewChartsPieCanvas'+sessionStorage.noOfUsers);
		                    					$('#'+getUserNumber(userNumberArray[i]+'')).find('.ViewChartsPieCanvas3').removeClass('ViewChartsPieCanvas3');
		                    					$('#'+getUserNumber(userNumberArray[i]+'')).find('.ViewChartsBarCanvas3').addClass('ViewChartsBarCanvas'+sessionStorage.noOfUsers);
		                    					$('#'+getUserNumber(userNumberArray[i]+'')).find('.ViewChartsBarCanvas3').removeClass('ViewChartsBarCanvas3');
		                    				}
										}
										else{
											if($('#'+getUserNumber(userNumberArray[i]+'')).find($("div.preChartContainer")).length > 0){
												if(sessionStorage.noOfUsers != 1){
		                        					$('#'+getUserNumber(userNumberArray[i]+'')).find('.preChartContainer3').addClass('preChartContainer'+sessionStorage.noOfUsers);
		                        					$('#'+getUserNumber(userNumberArray[i]+'')).find('.preChartContainer3').removeClass('preChartContainer3');
		                        				}
											}
										}
									}
                    				if(j%2 == 0){
                    					$('#'+getUserNumber(userNumberArray[i]+'')).removeClass()
                    					$('#'+getUserNumber(userNumberArray[i]+'')).addClass(getUserNumber(userNumberArray[i]+'')+"_left_two" , 1500);
                    				}
                    				else {
                    					$('#'+getUserNumber(userNumberArray[i]+'')).removeClass()
                    					$('#'+getUserNumber(userNumberArray[i]+'')).addClass(getUserNumber(userNumberArray[i]+'')+"_right_two" , 1500);
                    				}
                    				j++;
                    			}
                    		}
                        }
                        else{
                            if(sessionStorage.noOfUsers == 3){
                            	j=0;
                                for(var i=0 ; i<userArray.length ; i++){
                        			if(userArray[i] == true){
                        				if($('#'+getUserNumber(userNumberArray[i]+'')).find($("div.devicesContainer")).length > 0){
						            		if(sessionStorage.noOfUsers != 1){
			                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.level4').addClass('level'+sessionStorage.noOfUsers);
			                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.level4').removeClass('level4');
			                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.money4').addClass('money'+sessionStorage.noOfUsers);
			                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.money4').removeClass('money4');
			                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.badges4').addClass('badges'+sessionStorage.noOfUsers);
			                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.badges4').removeClass('badges4');
			                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.pieCanvas4').addClass('pieCanvas'+sessionStorage.noOfUsers);
			                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.pieCanvas4').removeClass('pieCanvas4');
			                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.NoBadgesTitle4').addClass('NoBadgesTitle'+sessionStorage.noOfUsers);
			                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.NoBadgesTitle4').removeClass('NoBadgesTitle4');
			                					$('#'+getUserNumber(userNumberArray[i]+'')).find('.badgesTitle').hide();
			                				}
										}
										else{
											if($('#'+getUserNumber(userNumberArray[i]+'')).find($("div.chartContainer")).length > 0){
												if(sessionStorage.noOfUsers != 1){
			                    					$('#'+getUserNumber(userNumberArray[i]+'')).find('.ViewChartsPieCanvas4').addClass('ViewChartsPieCanvas'+sessionStorage.noOfUsers);
			                    					$('#'+getUserNumber(userNumberArray[i]+'')).find('.ViewChartsPieCanvas4').removeClass('ViewChartsPieCanvas4');
			                    					$('#'+getUserNumber(userNumberArray[i]+'')).find('.ViewChartsBarCanvas4').addClass('ViewChartsBarCanvas'+sessionStorage.noOfUsers);
			                    					$('#'+getUserNumber(userNumberArray[i]+'')).find('.ViewChartsBarCanvas4').removeClass('ViewChartsBarCanvas4');
			                    				}
											}
											else{
												if($('#'+getUserNumber(userNumberArray[i]+'')).find($("div.preChartContainer")).length > 0){
													if(sessionStorage.noOfUsers != 1){
			                        					$('#'+getUserNumber(userNumberArray[i]+'')).find('.preChartContainer4').addClass('preChartContainer'+sessionStorage.noOfUsers);
			                        					$('#'+getUserNumber(userNumberArray[i]+'')).find('.preChartContainer4').removeClass('preChartContainer4');
			                        				}
												}
											}
										}
                        				if(j==2){
                        					$('#'+getUserNumber(userNumberArray[i]+'')).removeClass()
                            				$('#'+getUserNumber(userNumberArray[i]+'')).addClass(getUserNumber(userNumberArray[i]+'')+"_middle_three" , 1500);
                        				}
                        				else{
                        					if(j%2 == 0){
                            					$('#'+getUserNumber(userNumberArray[i]+'')).removeClass()
                            					$('#'+getUserNumber(userNumberArray[i]+'')).addClass(getUserNumber(userNumberArray[i]+'')+"_left_three" , 1500);
                            				}
                            				else {
                            					$('#'+getUserNumber(userNumberArray[i]+'')).removeClass()
                            					$('#'+getUserNumber(userNumberArray[i]+'')).addClass(getUserNumber(userNumberArray[i]+'')+"_right_three" , 1500);
                            				}
                        				}
                        				
                        				j++;
                        			}
                        		}
                            }
                            else{
                            }
                        }
                    }
                }
            	// window[ chan + window["{{userNumber}}"] ].unbind('client-goToAddDevice', goToAddDevice);
            	window[ chan + window["{{userNumber}}"] ].unbind('client-logout',window['{{userID}}logOutViewCharts']);
            	window[ chan + window["{{userNumber}}"] ].unbind('client-goBackToProfile',window['{{userID}}backToProfile']);
            	window[ chan + window["{{userNumber}}"] ].unbind('client-scrollUpViewCharts',window['{{userNumber}}scrollUp']);
				window[ chan + window["{{userNumber}}"] ].unbind('client-scrollDownViewCharts',window['{{userNumber}}scrollDown']);
				renderCharts();
            	var triggered = window[ chan + window["{{userNumber}}"] ].trigger('client-loadingComplete', {});
            }
		});
	};

	//------------------------------------------------------------------------------------------------------------------------------------

	window['{{userID}}backToProfile'] = function(data) {
	                        setTimeout(function () {
	                            $.ajax({
	                                url: "/profile/"+"{{userID}}"+"/"+"{{userNumber}}"+"/"+window["{{userNumber}}Privacy"]+"/",
	                                type: "GET",
	                                data: {
	                                    'csrfmiddlewaretoken' : "{{csrf_token}}", 
	                                    'userID':'{{userID}}'
	                                },
	                                success: function(data){
	                                	if(window["{{userNumber}}"] == 1){
									        userActivityDetected1();
									    }
									    else{
									        if(window["{{userNumber}}"] == 2){
									            userActivityDetected2();
									        }
									        else{
									            if(window["{{userNumber}}"] == 3){
									                userActivityDetected3();
									            }
									            else{
									                userActivityDetected4();
									            }
									        }
									    }
	                                    window[ chan + window["{{userNumber}}"] ].unbind('client-goBackToProfile',window['{{userID}}backToProfile']);
	                                    window[ chan + window["{{userNumber}}"] ].unbind('client-logout',window['{{userID}}logOutViewCharts']);
	                                    window[ chan + window["{{userNumber}}"] ].unbind('client-scrollUpViewCharts',window['{{userNumber}}scrollUp']);
										window[ chan + window["{{userNumber}}"] ].unbind('client-scrollDownViewCharts',window['{{userNumber}}scrollDown']);
	                                    $('#'+"{{userNumber}}").html(data);
	                                    if($('#'+"{{userNumber}}").find($("div.devicesContainer")).length > 0){
						            		if(sessionStorage.noOfUsers != 1){
		                    					$('#'+"{{userNumber}}").find('.level').addClass('level'+sessionStorage.noOfUsers);
		                    					$('#'+"{{userNumber}}").find('.level').removeClass('level');
		                    					$('#'+"{{userNumber}}").find('.money').addClass('money'+sessionStorage.noOfUsers);
		                    					$('#'+"{{userNumber}}").find('.money').removeClass('money');
		                    					$('#'+"{{userNumber}}").find('.badges').addClass('badges'+sessionStorage.noOfUsers);
		                    					$('#'+"{{userNumber}}").find('.badges').removeClass('badges');
		                    					$('#'+"{{userNumber}}").find('.pieCanvas').addClass('pieCanvas'+sessionStorage.noOfUsers);
		                    					$('#'+"{{userNumber}}").find('.pieCanvas').removeClass('pieCanvas');
		                    					$('#'+"{{userNumber}}").find('.NoBadgesTitle').addClass('NoBadgesTitle'+sessionStorage.noOfUsers);
		                    					$('#'+"{{userNumber}}").find('.NoBadgesTitle').removeClass('NoBadgesTitle');
		                    					$('#'+"{{userNumber}}").find('.privacyProtectedTitleProfile').addClass('privacyProtectedTitleProfile'+sessionStorage.noOfUsers);
		                    					$('#'+"{{userNumber}}").find('.privacyProtectedTitleProfile').removeClass('privacyProtectedTitleProfile');
		                    					$('#'+"{{userNumber}}").find('.badgesTitle').hide();
		                    				}
										}
										else{
											if($('#'+"{{userNumber}}").find($("div.chartContainer")).length > 0){
												if(sessionStorage.noOfUsers != 1){
		                        					$('#'+"{{userNumber}}").find('.ViewChartsPieCanvas').addClass('ViewChartsPieCanvas'+sessionStorage.noOfUsers);
		                        					$('#'+"{{userNumber}}").find('.ViewChartsPieCanvas').removeClass('ViewChartsPieCanvas');
		                        					$('#'+"{{userNumber}}").find('.ViewChartsBarCanvas').addClass('ViewChartsBarCanvas'+sessionStorage.noOfUsers);
		                        					$('#'+"{{userNumber}}").find('.ViewChartsBarCanvas').removeClass('ViewChartsBarCanvas');
		                        					$('#'+"{{userNumber}}").find('.privacyProtectedViewChart').addClass('privacyProtectedViewChart'+sessionStorage.noOfUsers);
		                        					$('#'+"{{userNumber}}").find('.privacyProtectedViewChart').removeClass('privacyProtectedViewChart');
		                        					
		                        				}
											}
											else{
												if($('#'+"{{userNumber}}").find($("div.preChartContainer")).length > 0){
													if(sessionStorage.noOfUsers != 1){
		                            					$('#'+"{{userNumber}}").find('.preChartContainer').addClass('preChartContainer'+sessionStorage.noOfUsers);
			                        					$('#'+"{{userNumber}}").find('.preChartContainer').removeClass('preChartContainer');
			                        				}
												}
											}
										}
										renderCharts();
	                                    var triggered = window[ chan + window["{{userNumber}}"] ].trigger('client-loadingComplete', {});
	                                }
	                            });
	                        }, 1000);
	                    };



	//charts section ---------------------------------------------------------------------------------------------------------------------

	// function getRandomColor() {
	// 	var letters = '0123456789ABCDEF'.split('');
	// 	var color = '#';
	// 	for (var i = 0; i < 6; i++ ) {
	// 		color += letters[Math.round(Math.random() * 15)];
	// 	}
	// 	return color;
	// }

	// window.onload = function () {
	// 	chart.render();
	// }	
	window['{{userID}}'+"PieChart"] = [];
	window['{{userID}}'+"BarChart"] = [];
	window['{{userID}}'+"RadarChart"] = [];
	window['{{userID}}'+"barDataSets"] = [];
	window['{{userID}}'+"barData"] = [];
	window['{{userID}}'+"radarDataSets"] =[];
	window['{{userID}}'+"radarData"] = [];
	window['{{userID}}barDataPoints']=[];

	{% for device,usage in devices_and_usage %}
		window['{{userID}}'+"PieChart"] = window['{{userID}}'+"PieChart"].concat({ label:'{{device.name}} '+parseInt('{{usage}}')+'%',y: (parseInt('{{usage}}'))});
	{% endfor %}

	{% for c in devicesLoopCounter %}
		window['{{userID}}'+'barDataPoints'] = window['{{userID}}'+'barDataPoints'].concat(
				{
					indexLabelPlacement: "inside",
					type: "column",
			        showInLegend: true,
			        legendText: {{devicesName|safe}}[{{c}}],
					dataPoints:[
						{% for counter in MonthsloopCounter %}
							{
								y:{{devicesMonthlyUsage}}[{{counter}}][{{c}}],
								indexLabel:{{devicesMonthlyUsage}}[{{counter}}][{{c}}]+'',
								label:{{monthsChosenString|safe}}[{{counter}}]
								
							},
						{% endfor %}
					]
				}
			); 
	{% endfor %}
	
	{% ifequal privacyStatus 'high' %}
		var triggered = window[ chan + window["{{userNumber}}"] ].trigger('client-view_charts', {'viewChartPieData': window['{{userID}}'+"PieChart"] ,'viewChartBarData':window['{{userID}}'+'barDataPoints']});
	{% endifequal %}

	{% if usagesLength > 0 %}
		{% ifequal privacyStatus 'low' %}
			window['{{userNumber}}PiechartViewChart'] = new CanvasJS.Chart("{{userID}}PieCanvas", {
				theme: "theme2",//theme1
				title:{
					text: "Total energy usage within the dates entered"              
				},
				data: [              
					{
					type: "pie",
					dataPoints: window['{{userID}}'+"PieChart"]
					}
				]
			});
			window['{{userNumber}}PiechartViewChart'].render();

			window['{{userNumber}}BarchartViewChart'] = new CanvasJS.Chart("{{userID}}BarCanvas", {
				theme: "theme1",//theme1
				title:{
					text: "Total energy usage within the dates entered sorted monthly"             
				},
				data:window['{{userID}}'+'barDataPoints']
		  	});
			window['{{userNumber}}BarchartViewChart'].render();
		{% endifequal %}
	{% else %}

	{% endif %}

  	//------------------------------------------------------------------------------------
  	window['{{userNumber}}scrollUp'] = function(data) {
  		if(window["{{userNumber}}"] == 1){
            userActivityDetected1();
        }
        else{
            if(window["{{userNumber}}"] == 2){
                userActivityDetected2();
            }
            else{
                if(window["{{userNumber}}"] == 3){
                    userActivityDetected3();
                }
                else{
                    userActivityDetected4();
                }
            }
        }
		var y = $('#{{userNumber}}').scrollTop();
		$('#{{userNumber}}').scrollTop(y+150);
	}

	window['{{userNumber}}scrollDown'] = function(data) {
		if(window["{{userNumber}}"] == 1){
            userActivityDetected1();
        }
        else{
            if(window["{{userNumber}}"] == 2){
                userActivityDetected2();
            }
            else{
                if(window["{{userNumber}}"] == 3){
                    userActivityDetected3();
                }
                else{
                    userActivityDetected4();
                }
            }
        }
		var y = $('#{{userNumber}}').scrollTop();
		$('#{{userNumber}}').scrollTop(y-150);
	}

	window[ chan + window["{{userNumber}}"] ].bind('client-scrollUpViewCharts',window['{{userNumber}}scrollUp']);
	window[ chan + window["{{userNumber}}"] ].bind('client-scrollDownViewCharts',window['{{userNumber}}scrollDown']);
  	window[ chan + window["{{userNumber}}"] ].bind('client-goBackToProfile',window['{{userID}}backToProfile']);
	window[ chan + window["{{userNumber}}"] ].bind('client-logout',window['{{userID}}logOutViewCharts']);
</script>
<div id="{{userID}}charts" class="chartContainer">
	<div id="{{userID}}" class="iuserdViewCharts" style="display:none;"></div>
	<div id="{{userID}}viewCharts">
		{% if usagesLength > 0 %}
			{% ifequal privacyStatus 'low' %}
				<div id="{{userID}}PieCanvas" class="ViewChartsPieCanvas"></div>
				<div id="{{userID}}BarCanvas" class="ViewChartsBarCanvas"></div>
			{% else %}
				<div id="{{user_id}}privacyProtected" class="privacyProtectedViewChart">
					<h1>PRIVACY PROTECTED!</h1>
				</div>
			{% endifequal %}
		{% else %}
			<p class="NoChartViewChart">You don't have any data/charts yet</p>
		{% endif %}
	</div>
	<!-- <div id="{{userID}}RadarCanvas" style="width:40%;height:40%"></div> -->
</div>